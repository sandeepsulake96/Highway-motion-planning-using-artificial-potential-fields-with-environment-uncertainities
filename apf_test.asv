% road mesh
x = 0:2:200;
y = -4:0.1:4;
[X,Y] = meshgrid(x,y);
%F = zeros*X;
%surf(X,Y,F)


%% Parameters

k_tar = 0.25
k_b1 = 0.5;
k_b2 = 0.5;
k_c = 6.5;
si_c =0.5;
k_obs= 10;
sx=2;   %10
sy= 10;   %1.4
k1= 0.005;
k2=0.005;
gamma =0;


% Target position (for target attraction)
x_tar = 190*ones(size(X));
y_tar = 2;
Y1=4*ones(size(Y))';  %left boundary
YC=0*ones(size(Y))';   %center line
Y2=-4*ones(size(Y))';   % right boundary


%% Target potential

u_tar = -k_tar*(x-x_tar);

figure(1)
surf(X,Y,u_tar)



%% Road Potential

% edge potential
d1 = (y-Y1); d2= y-Y2;
u_e = (k_b1./d1.^2) + (k_b2./d2.^2);      %k_edge*(-exp(Y-Y1)+1);
u_e=u_e';                                           % u_edge2 = k_edge*(-exp(Y-Y2)+1);

% centerline potential
dc = y-YC;
u_c =  k_c*exp(-(dc.^2)./ (2*si_c^2));
u_c = u_c';

%total road potential

u_r =u_e+u_c;
                                        
surf(X,Y,u_r);

%%    Obstacle 

%testing static obstacle potential
x_obs = 70;
y_obs = 2;

v=0;
v_obs =0;

u_car1 = k_obs*exp(- ((((X-x_obs).^2)./sx^2) + (((Y-y_obs).^2./sy^2))) + gamma*((x-x_obs).^2./sx^2)*(k1*v+k2*(v-v_obs)));

surf(X,Y,u_car1+u_r)

%%
















